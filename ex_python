import psycopg2

conn = psycopg2.connect(
        host = 'localhost',
        port = '5432',
        dbname = 'pbd',
        user = 'postgres',
        password = '123456'
    )
print("Connection established")

cur = conn.cursor()

class Usuario: ##classe super coesa - unico objetivo dela é definir o que é usuáriov
    def __init__(self, login, senha):
        self.login = login
        self.senha = senha

def existe(usuario): 
#obtem um cursor
            cur.execute (
            'SELECT * FROM  tb_usuario WHERE login = %s AND senha = %s',
            (usuario.login, usuario.senha))

        #usando o cursor, verificar resultado
            resultado = cur.fetchone()

        #devolve True ou False
            return resultado != None

def cria(usuario):
    cur.execute("insert into tb_usuario (login, senha) values (%s,%s);",(f'{usuario.login}',f' {usuario.senha}'))
    conn.commit()
    return cur.rowcount >=1
